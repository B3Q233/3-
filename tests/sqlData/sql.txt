CREATE DATABASE IF NOT EXISTS AIChat;
use AIChat;
CREATE TABLE users
(
    id       INT AUTO_INCREMENT PRIMARY KEY,
    email    VARCHAR(30)  NOT NULL,
    api_key  VARCHAR(255) NULL,
    password VARCHAR(20)  NOT NULL,
    username VARCHAR(20)  NOT NULL,
    quota    INT          DEFAULT 0 NULL,
    level    INT          DEFAULT 0 NULL,
    CONSTRAINT email UNIQUE (email),
    CONSTRAINT username UNIQUE (username)
);

create table admin
(
    admin_id   int auto_increment
        primary key,
    admin_name varchar(50) not null,
    password   varchar(20) not null,
    email      varchar(20) not null
);
create table models
(
    model_id          int auto_increment
        primary key,
    model_name        varchar(100) not null,
    model_category    varchar(50)  not null,
    initial_text      varchar(500) not null,
    model_description varchar(500) not null,
    constraint model_name
        unique (model_name)
);

-- auto-generated definition
create table user_model_usage
(
    user_id       int          not null,
    model_id      int          not null,
    usage_content varchar(200) not null,
    usage_time    datetime     not null,
    primary key (user_id, model_id),
    FOREIGN KEY (user_id) REFERENCES users (id),
    FOREIGN KEY (model_id) REFERENCES models (model_id)
);
CREATE TABLE user_online_status
(
    id                INT AUTO_INCREMENT PRIMARY KEY,
    user_id           INT NOT NULL unique,
    is_online         TINYINT(1) NOT NULL,
    last_sign_in_time DATETIME DEFAULT '1970-01-01 00:00:00' ,
    CONSTRAINT fk_user
        FOREIGN KEY (user_id)
        REFERENCES users (id)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);

